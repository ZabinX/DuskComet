<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>DuskCheerpJ test</title>
    <script src="https://cjrtnc.leaningtech.com/20250618_2540/loader.js"></script>
  </head>
  <body>
<script>
  (async function () {
    try {
      // 1. Initialize CheerpJ
      await cheerpjInit();
      cheerpjCreateDisplay(1280, 720);

      // 2. Fetch the JAR file's data
      const response = await fetch('./duskclient.jar');
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const jarData = await response.arrayBuffer();

      // 3. Create the virtual /app directory using the CORRECT older function name.
      await cheerpjMkdir("/app");

      // 4. Add the JAR file using the CORRECT older function name.
      await cheerpjAddStringFile("/app/duskclient.jar", new Uint8Array(jarData));

      // 5. Run the JAR from the virtual filesystem.
      await cheerpjRunJar("/app/duskclient.jar");

      // 6. Connect to the game server.
      await cheerpjRunMain("Dusk", "dusk.coat-richter.ts.net", "443");

    } catch (error) {
      // If anything goes wrong, log it to the console for debugging.
      console.error("CheerpJ startup error:", error);
    }
  })();
</script>
  </body>
</html>
